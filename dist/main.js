!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}n.r(t);var r=new(function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),e.instance||this.setProps(),e.instance}var t,n,r;return t=e,(n=[{key:"setProps",value:function(){var t=this;this.xSize=parseInt("7"),this.ySize=parseInt("15"),this.side=Math.floor(window.screen.height/100*70/this.ySize),this.defaultFieldCell={color:"#fff",borderColor:"#000",value:0},this.field=Array(this.ySize).fill().map((function(){return Array(t.xSize).fill(t.defaultFieldCell)})),this.active=!0,this.score=0,e.instance=this}},{key:"setX",value:function(t){e.instance.xSize=t}},{key:"setY",value:function(t){e.instance.ySize=t}},{key:"setSide",value:function(t){e.instance.side=t}},{key:"setField",value:function(t){e.instance.field=t}},{key:"toggleActive",value:function(){this.active=!this.active}},{key:"checkField",value:function(){var e=this;this.field.forEach((function(t,n){var o=!0;t.map((function(e){0==e.value&&(o=!1)})),o&&(e.field.splice(n,1),e.field.unshift(Array(e.xSize).fill(e.defaultFieldCell)),e.setScore())}))}},{key:"refresh",value:function(){this.setProps()}},{key:"setScore",value:function(){this.score+=parseInt("10"),document.querySelector(".scoreValue").innerHTML=this.score}}])&&o(t.prototype,n),r&&o(t,r),e}());function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var c=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),e.instancev||this.setProps()}var t,n,o;return t=e,(n=[{key:"setProps",value:function(){this.canvas=document.getElementById("tetris"),this.setResolution(),this.context=this.canvas.getContext("2d")}},{key:"setResolution",value:function(){this.canvas.width=r.xSize*r.side,this.canvas.height=r.ySize*r.side}},{key:"drawCell",value:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r.side,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"#000",c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"#fff",u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;e.beginPath(),e.rect(t,n,o,o),e.fillStyle=c,e.fill(),e.lineWidth=u,e.strokeStyle=i,e.stroke()}},{key:"drawField",value:function(){for(var e=0,t=0,n=0;n<r.ySize;n++){for(var o=0;o<r.xSize;o++)0==r.field[n][o].value?this.drawCell(this.context,e,t,r.side):this.drawCell(this.context,e,t,r.side,r.field[n][o].borderColor,r.field[n][o].color),e+=r.side;t+=r.side,e=0}}}])&&i(t.prototype,n),o&&i(t,o),e}());function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[[0,1,0],[1,1,1]];u(this,e),this.x=t,this.y=n,this.shape=o,this.color="#4CAF50",this.borderColor="#ff7043"}var t,n,o;return t=e,(n=[{key:"setX",value:function(e){this.x=e}},{key:"setY",value:function(e){this.y=e}},{key:"rotate",value:function(){for(var e=[],t=this.shape[0].length-1;t>=0;t--){e.push(Array(this.shape.length).fill(0));for(var n=0;n<this.shape.length;n++)e[e.length-1][n]=this.shape[n][t]}if(this.checkCollision(this.x,this.y,e))return!1;this.shape=e}},{key:"draw",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.context,t=this.x,n=this.y,o=0;o<this.shape.length;o++){for(var i=0;i<this.shape[o].length;i++)1==this.shape[o][i]&&c.drawCell(e,t,n,r.side,this.borderColor,this.color),t+=r.side;n+=r.side,t=this.x}}},{key:"move",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"down",n=this.x,o=this.y;switch(t){case"up":o-=e;break;case"down":o+=e;break;case"left":n-=e;break;case"right":n+=e}if(this.checkCollision(n,o))switch(t){case"down":this.freeze();break;default:return!1}else this.x=n,this.y=o}},{key:"checkCollision",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.shape;if(e<0||t<0)return!0;var o=e/r.side,i=t/r.side;if(i+n.length>r.ySize||o+n[0].length>r.xSize)return!0;for(var c=0;c<n.length;c++)for(var u=0;u<n[c].length;u++)if(1==r.field[i+c][o+u].value&&1==n[c][u])return!0;return!1}},{key:"freeze",value:function(){for(var e=this.x/r.side,t=this.y/r.side,n=this.shape.length-1;n>=0;n--)for(var o=this.shape[n].length-1;o>=0;o--)0!=this.shape[n][o]&&(r.field[t+n][e+o]={value:1,color:this.color,borderColor:this.borderColor});q.refreshBlock()}}])&&l(t.prototype,n),o&&l(t,o),e}();function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=function(e){function t(e,n){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=s(this,h(t).call(this,e,n,[[1,1],[1,1]]))).color="#ff7043",o.borderColor="#bf360c",o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(t,e),t}(a);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m=function(e){function t(e,n){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=b(this,v(t).call(this,e,n,[[1,1,1,1]]))).color="#009688",o.borderColor="#004d40",o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(t,e),t}(a);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _=function(e){function t(e,n){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=k(this,O(t).call(this,e,n,[[0,1,1],[1,1,0]]))).color="#cddc39",o.borderColor="#9e9d24",o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(t,e),t}(a);function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){return!t||"object"!==j(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var C=function(e){function t(e,n){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=P(this,x(t).call(this,e,n,[[1,1,0],[0,1,1]]))).color="#ffa726",o.borderColor="#e65100",o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(t,e),t}(a);function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B(e,t){return!t||"object"!==T(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function z(e){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function F(e,t){return(F=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var R=function(e){function t(e,n){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=B(this,z(t).call(this,e,n,[[1,0,0],[1,1,1]]))).color="#1E88E5",o.borderColor="#0D47A1",o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&F(e,t)}(t,e),t}(a);function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function L(e,t){return!t||"object"!==A(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function I(e,t){return(I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var X=function(e){function t(e,n){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=L(this,M(t).call(this,e,n,[[0,0,1],[1,1,1]]))).color="#7e57c2",o.borderColor="#311b92",o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I(e,t)}(t,e),t}(a);function Y(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var D=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,(n=[{key:"getRandomBlock",value:function(e,t){switch(Math.round(6*Math.random()+1)){case 1:return new p(e,t);case 2:return new a(e,t);case 3:return new m(e,t);case 4:return new _(e,t);case 5:return new C(e,t);case 6:return new R(e,t);case 7:return new X(e,t);default:return new a(e,t)}}}])&&Y(t.prototype,n),o&&Y(t,o),e}();function N(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var q=new(function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),e.instance||this.setProps(),e.instance}var t,n,o;return t=e,(n=[{key:"setProps",value:function(){this.blockPicker=new D,this.block=this.blockPicker.getRandomBlock(0,0),this.nextBlock=this.blockPicker.getRandomBlock(0,0),e.instance=this}},{key:"setX",value:function(t){e.instance.xSize=t}},{key:"setY",value:function(t){e.instance.ySize=t}},{key:"setSide",value:function(t){e.instance.side=t}},{key:"setField",value:function(t){e.instance.field=t}},{key:"refreshBlock",value:function(){this.block=this.nextBlock,this.nextBlock=this.blockPicker.getRandomBlock(0,0),this.drawNextBlock()}},{key:"drawNextBlock",value:function(){var e=document.getElementById("nextBlock");e.width=this.nextBlock.shape[0].length*r.side,e.height=this.nextBlock.shape.length*r.side;var t=e.getContext("2d");this.nextBlock.draw(t)}},{key:"refresh",value:function(){this.setProps()}}])&&N(t.prototype,n),o&&N(t,o),e}());document.addEventListener("DOMContentLoaded",(function(){var e=function(e){c.drawField(),q.block.draw()},t=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"down";q.block.move(t,n),e()},n=function(){q.block.rotate(),e(r.side)};c.drawField();for(var o=document.getElementsByClassName("moveBlock"),i=function(e){var n=o[e],i=n.dataset.direction;n.addEventListener("click",(function(){t(r.side,i)}))},u=0;u<o.length;u++)i(u);document.getElementById("restart").addEventListener("click",(function(){r.refresh(),q.refresh(),c.drawField()})),document.getElementById("pause").addEventListener("click",(function(){r.toggleActive()})),document.addEventListener("keydown",(function(e){r.active&&("ArrowDown"==e.key&&t(r.side,"down"),"ArrowUp"==e.key&&n(),"ArrowLeft"==e.key&&t(r.side,"left"),"ArrowRight"==e.key&&t(r.side,"right"))}),!1);setInterval((function(){r.active&&(t(r.side,"down"),r.checkField())}),1e3);document.addEventListener("touchstart",(function(e){var t=function(e){return e.touches||e.originalEvent.touches}(e)[0];a=t.clientX,f=t.clientY}),!1),document.addEventListener("touchmove",(function(e){if(!a||!f)return;var o=e.touches[0].clientX,i=e.touches[0].clientY,c=a-o,u=f-i;Math.abs(c)>Math.abs(u)?t(r.side,c>0?"left":"right"):u>0?n():t(r.side,"down");a=null,f=null}),!1);var l,a=null,f=null;var s,h,y=function(){l=setInterval((function(){r.active&&(t(r.side,"down"),r.checkField())}),100)};document.addEventListener("touchstart",(function(e){e.preventDefault(),h||(s=setTimeout(y,300),h=!0)}),!1),document.addEventListener("touchend",(function(){s&&(clearTimeout(s),clearInterval(l),h=!1)}),!1)}))}]);