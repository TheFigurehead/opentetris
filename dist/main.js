!function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}n.r(e);var r=new(function(){function t(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),t.instance||this.setProps(),t.instance}var e,n,r;return e=t,(n=[{key:"setProps",value:function(){var e=this;this.xSize=parseInt("7"),this.ySize=parseInt("15"),this.side=Math.floor(window.innerHeight/100*70/this.ySize),console.log(this.side),this.defaultFieldCell={color:"#fff",borderColor:"#000",value:0},this.field=Array(this.ySize).fill().map((function(){return Array(e.xSize).fill(e.defaultFieldCell)})),this.active=!0,this.score=0,t.instance=this}},{key:"setX",value:function(e){t.instance.xSize=e}},{key:"setY",value:function(e){t.instance.ySize=e}},{key:"setSide",value:function(e){t.instance.side=e}},{key:"setField",value:function(e){t.instance.field=e}},{key:"toggleActive",value:function(){this.active=!this.active}},{key:"checkField",value:function(){var t=this;this.field.forEach((function(e,n){var o=!0;e.map((function(t){0==t.value&&(o=!1)})),o&&(t.field.splice(n,1),t.field.unshift(Array(t.xSize).fill(t.defaultFieldCell)),t.setScore())}))}},{key:"refresh",value:function(){this.setProps()}},{key:"setScore",value:function(){this.score+=parseInt("10"),document.querySelector(".scoreValue").innerHTML=this.score}}])&&o(e.prototype,n),r&&o(e,r),t}());function i(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var c=new(function(){function t(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),t.instance||this.setProps(),t.instance}var e,n,o;return e=t,(n=[{key:"setProps",value:function(){this.canvas=document.getElementById("tetris"),this.setResolution(),this.context=this.canvas.getContext("2d"),t.instance=this}},{key:"setResolution",value:function(){this.canvas.width=r.xSize*r.side,this.canvas.height=r.ySize*r.side}},{key:"drawCell",value:function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r.side,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"#000",c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"#fff",u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;t.beginPath(),t.rect(e,n,o,o),t.fillStyle=c,t.fill(),t.lineWidth=u,t.strokeStyle=i,t.stroke()}},{key:"drawField",value:function(){for(var t=0,e=0,n=0;n<r.ySize;n++){for(var o=0;o<r.xSize;o++)0==r.field[n][o].value?this.drawCell(this.context,t,e,r.side):this.drawCell(this.context,t,e,r.side,r.field[n][o].borderColor,r.field[n][o].color),t+=r.side;e+=r.side,t=0}}}])&&i(e.prototype,n),o&&i(e,o),t}());function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[[0,1,0],[1,1,1]];u(this,t),this.x=e,this.y=n,this.shape=o,this.color="#4CAF50",this.borderColor="#ff7043"}var e,n,o;return e=t,(n=[{key:"setX",value:function(t){this.x=t}},{key:"setY",value:function(t){this.y=t}},{key:"rotate",value:function(){for(var t=[],e=this.shape[0].length-1;e>=0;e--){t.push(Array(this.shape.length).fill(0));for(var n=0;n<this.shape.length;n++)t[t.length-1][n]=this.shape[n][e]}if(this.checkCollision(this.x,this.y,t))return!1;this.shape=t}},{key:"draw",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.context,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.side,n=this.x,o=this.y,i=0;i<this.shape.length;i++){for(var u=0;u<this.shape[i].length;u++)1==this.shape[i][u]&&c.drawCell(t,n,o,e,this.borderColor,this.color),n+=e;o+=e,n=this.x}}},{key:"move",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"down",n=this.x,o=this.y;switch(e){case"up":o-=t;break;case"down":o+=t;break;case"left":n-=t;break;case"right":n+=t}if(this.checkCollision(n,o))switch(e){case"down":this.freeze();break;default:return!1}else this.x=n,this.y=o}},{key:"checkCollision",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.shape;if(t<0||e<0)return!0;var o=t/r.side,i=e/r.side;if(i+n.length>r.ySize||o+n[0].length>r.xSize)return!0;for(var c=0;c<n.length;c++)for(var u=0;u<n[c].length;u++)if(1==r.field[i+c][o+u].value&&1==n[c][u])return!0;return!1}},{key:"freeze",value:function(){for(var t=this.x/r.side,e=this.y/r.side,n=this.shape.length-1;n>=0;n--)for(var o=this.shape[n].length-1;o>=0;o--)0!=this.shape[n][o]&&(r.field[e+n][t+o]={value:1,color:this.color,borderColor:this.borderColor});H.refreshBlock()}}])&&s(e.prototype,n),o&&s(e,o),t}();function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function y(t,e){return(y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var d=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=f(this,h(e).call(this,t,n,[[1,1],[1,1]]))).color="#ff7043",o.borderColor="#bf360c",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}(e,t),e}(a);function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v(t,e){return!e||"object"!==p(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function w(t,e){return(w=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var m=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=v(this,b(e).call(this,t,n,[[1,1,1,1]]))).color="#009688",o.borderColor="#004d40",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}(e,t),e}(a);function k(t){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function g(t,e){return!e||"object"!==k(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function O(t){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function S(t,e){return(S=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=g(this,O(e).call(this,t,n,[[0,1,1],[1,1,0]]))).color="#cddc39",o.borderColor="#9e9d24",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&S(t,e)}(e,t),e}(a);function j(t){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function x(t,e){return!e||"object"!==j(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function E(t){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function P(t,e){return(P=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var T=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=x(this,E(e).call(this,t,n,[[1,1,0],[0,1,1]]))).color="#ffa726",o.borderColor="#e65100",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&P(t,e)}(e,t),e}(a);function C(t){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function B(t,e){return!e||"object"!==C(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function z(t){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function L(t,e){return(L=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var M=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=B(this,z(e).call(this,t,n,[[1,0,0],[1,1,1]]))).color="#1E88E5",o.borderColor="#0D47A1",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&L(t,e)}(e,t),e}(a);function D(t){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function F(t,e){return!e||"object"!==D(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function R(t){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function A(t,e){return(A=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var I=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=F(this,R(e).call(this,t,n,[[0,0,1],[1,1,1]]))).color="#7e57c2",o.borderColor="#311b92",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&A(t,e)}(e,t),e}(a);function X(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Y=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,o;return e=t,(n=[{key:"getRandomBlock",value:function(t,e){switch(Math.round(6*Math.random()+1)){case 1:return new d(t,e);case 2:return new a(t,e);case 3:return new m(t,e);case 4:return new _(t,e);case 5:return new T(t,e);case 6:return new M(t,e);case 7:return new I(t,e);default:return new a(t,e)}}}])&&X(e.prototype,n),o&&X(e,o),t}();function N(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var H=new(function(){function t(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),t.instance||(this.setProps(),this.drawNextBlock()),t.instance}var e,n,o;return e=t,(n=[{key:"setProps",value:function(){this.blockPicker=new Y,this.block=this.blockPicker.getRandomBlock(0,0),this.nextBlock=this.blockPicker.getRandomBlock(0,0),t.instance=this}},{key:"setX",value:function(e){t.instance.xSize=e}},{key:"setY",value:function(e){t.instance.ySize=e}},{key:"setSide",value:function(e){t.instance.side=e}},{key:"setField",value:function(e){t.instance.field=e}},{key:"refreshBlock",value:function(){this.block=this.nextBlock,this.nextBlock=this.blockPicker.getRandomBlock(0,0),this.drawNextBlock()}},{key:"drawNextBlock",value:function(){var t=r.side<20?r.side:20,e=document.getElementById("nextBlock");e.width=this.nextBlock.shape[0].length*t,e.height=this.nextBlock.shape.length*t;var n=e.getContext("2d");this.nextBlock.draw(n,t)}},{key:"pause",value:function(){r.toggleActive()}},{key:"refresh",value:function(){this.setProps()}},{key:"drawBlock",value:function(){c.drawField(),this.block.draw()}},{key:"moveBlock",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"down";this.block.move(t,e),this.drawBlock(t)}},{key:"rotate",value:function(){this.block.rotate(),this.drawBlock(r.side)}},{key:"restart",value:function(){r.refresh(),this.refresh(),c.drawField()}}])&&N(e.prototype,n),o&&N(e,o),t}());function q(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var U=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.xDown=null,this.yDown=null,this.move=!1,this.timer,this.lockTimer,this.touchduration=300,this.interval=!1,this.shorttouch,this.handleTouchStart=this.handleTouchStart.bind(this),this.handleTouchMove=this.handleTouchMove.bind(this),this.handleTouchEnd=this.handleTouchEnd.bind(this),this.onLongTouch=this.onLongTouch.bind(this),this.addEventsListeners()}var e,n,o;return e=t,(n=[{key:"addEventsListeners",value:function(){var t=document.getElementById("tetris");t.addEventListener("touchstart",this.handleTouchStart,!1),t.addEventListener("touchmove",this.handleTouchMove,!1),t.addEventListener("touchend",this.handleTouchEnd,!1)}},{key:"handleTouchStart",value:function(t){var e=this.getTouches(t)[0];this.xDown=e.clientX,this.yDown=e.clientY,this.shorttouch=!0,this.lockTimer||(this.timer=setTimeout(this.onLongTouch,this.touchduration),this.lockTimer=!0)}},{key:"handleTouchMove",value:function(t){if(this.xDown&&this.yDown){this.move=!0;var e=t.touches[0].clientX,n=t.touches[0].clientY,o=this.xDown-e,i=this.yDown-n;Math.abs(o)>Math.abs(i)?o>0?H.moveBlock(r.side,"left"):H.moveBlock(r.side,"right"):i<0&&H.moveBlock(r.side,"down"),this.xDown=null,this.yDown=null}}},{key:"handleTouchEnd",value:function(){this.timer&&(clearTimeout(this.timer),clearInterval(this.interval),this.lockTimer=!1),this.shorttouch&&!this.move&&H.rotate(),this.move=!1}},{key:"getTouches",value:function(t){return t.touches||t.originalEvent.touches}},{key:"onLongTouch",value:function(){var t=this;this.interval=setInterval((function(){t.shorttouch=!1,r.active&&(H.moveBlock(r.side,"down"),r.checkField())}),100)}}])&&q(e.prototype,n),o&&q(e,o),t}();document.addEventListener("DOMContentLoaded",(function(){new U;c.drawField();for(var t=document.getElementsByClassName("moveBlock"),e=function(e){var n=t[e],o=n.dataset.direction;n.addEventListener("click",(function(){H.moveBlock(r.side,o)}))},n=0;n<t.length;n++)e(n);document.getElementById("restart").addEventListener("click",(function(){H.restart()})),document.getElementById("pause").addEventListener("click",(function(){H.pause()})),document.addEventListener("keydown",(function(t){r.active&&("ArrowDown"==t.key&&H.moveBlock(r.side,"down"),"ArrowUp"==t.key&&H.rotate(),"ArrowLeft"==t.key&&H.moveBlock(r.side,"left"),"ArrowRight"==t.key&&H.moveBlock(r.side,"right"))}),!1);setInterval((function(){r.active&&(H.moveBlock(r.side,"down"),r.checkField())}),1e3)}))}]);