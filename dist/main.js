!function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}n.r(e);var r=new(function(){function t(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),t.instance||this.setProps(),t.instance}var e,n,r;return e=t,(n=[{key:"setProps",value:function(){var e=this;this.xSize=parseInt("7"),this.ySize=parseInt("15"),this.side=Math.floor(window.innerHeight/100*70/this.ySize),this.defaultFieldCell={color:"#fff",borderColor:"#000",value:0},this.field=Array(this.ySize).fill().map((function(){return Array(e.xSize).fill(e.defaultFieldCell)})),this.active=!0,this.score=0,t.instance=this}},{key:"setX",value:function(e){t.instance.xSize=e}},{key:"setY",value:function(e){t.instance.ySize=e}},{key:"setSide",value:function(e){t.instance.side=e}},{key:"setField",value:function(e){t.instance.field=e}},{key:"toggleActive",value:function(){this.active=!this.active}},{key:"checkField",value:function(){var t=this;this.field.forEach((function(e,n){var o=!0;e.map((function(t){0==t.value&&(o=!1)})),o&&(t.field.splice(n,1),t.field.unshift(Array(t.xSize).fill(t.defaultFieldCell)),t.setScore())}))}},{key:"refresh",value:function(){this.setProps()}},{key:"setScore",value:function(){this.score+=parseInt("10"),document.querySelector(".scoreValue").innerHTML=this.score}}])&&o(e.prototype,n),r&&o(e,r),t}());function i(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var c=new(function(){function t(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),t.instance||this.setProps(),t.instance}var e,n,o;return e=t,(n=[{key:"setProps",value:function(){this.canvas=document.getElementById("tetris"),this.setResolution(),this.context=this.canvas.getContext("2d"),t.instance=this}},{key:"setResolution",value:function(){this.canvas.width=r.xSize*r.side,this.canvas.height=r.ySize*r.side}},{key:"drawCell",value:function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r.side,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"#000",c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"#fff",u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;t.beginPath(),t.rect(e,n,o,o),t.fillStyle=c,t.fill(),t.lineWidth=u,t.strokeStyle=i,t.stroke()}},{key:"drawField",value:function(){for(var t=0,e=0,n=0;n<r.ySize;n++){for(var o=0;o<r.xSize;o++)0==r.field[n][o].value?this.drawCell(this.context,t,e,r.side):this.drawCell(this.context,t,e,r.side,r.field[n][o].borderColor,r.field[n][o].color),t+=r.side;e+=r.side,t=0}}},{key:"drawEndGame",value:function(){var t=[{size:"28px",text:"This is the end...",color:"#1a237e",font:"Lemonada"},{size:"28px",text:"My only friend, the end...",color:"#1a237e",font:"Lemonada"},{size:"32px",text:"Total score:",color:"#3e2723",font:"Roboto"},{size:"34px",text:r.score,color:"#3e2723",font:"Roboto"}],e=this.canvas.height/2-"50"*t.length/2;this.context.filter="blur(15px)",this.drawField(),this.context.filter="blur(0px)",this.context.textAlign="center";for(var n=0;n<t.length;n++)this.context.fillStyle=t[n].color,this.context.font="normal normal bold "+t[n].size+" "+t[n].font,this.context.fillText(t[n].text,this.canvas.width/2,e+"50"*n,this.canvas.width-20)}}])&&i(e.prototype,n),o&&i(e,o),t}());function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var l=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[[0,1,0],[1,1,1]];u(this,t),this.x=e,this.y=n,this.shape=o,this.color="#4CAF50",this.borderColor="#ff7043"}var e,n,o;return e=t,(n=[{key:"setX",value:function(t){this.x=t}},{key:"setY",value:function(t){this.y=t}},{key:"rotate",value:function(){for(var t=[],e=this.shape[0].length-1;e>=0;e--){t.push(Array(this.shape.length).fill(0));for(var n=0;n<this.shape.length;n++)t[t.length-1][n]=this.shape[n][e]}if(this.checkCollision(this.x,this.y,t))return!1;this.shape=t}},{key:"draw",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.context,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.side,n=this.x,o=this.y,i=0;i<this.shape.length;i++){for(var u=0;u<this.shape[i].length;u++)1==this.shape[i][u]&&c.drawCell(t,n,o,e,this.borderColor,this.color),n+=e;o+=e,n=this.x}}},{key:"move",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"down",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.side,n=this.x,o=this.y;switch(t){case"up":o-=e;break;case"down":o+=e;break;case"left":n-=e;break;case"right":n+=e}if(this.checkCollision(n,o))switch(t){case"down":return this.freeze();default:return!1}else this.x=n,this.y=o;return!0}},{key:"checkCollision",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.shape;if(t<0||e<0)return!0;var o=t/r.side,i=e/r.side;if(i+n.length>r.ySize||o+n[0].length>r.xSize)return!0;for(var c=0;c<n.length;c++)for(var u=0;u<n[c].length;u++)if(1==r.field[i+c][o+u].value&&1==n[c][u])return!0;return!1}},{key:"freeze",value:function(){for(var t=this.x/r.side,e=this.y/r.side,n=this.shape.length-1;n>=0;n--)for(var o=this.shape[n].length-1;o>=0;o--)0!=this.shape[n][o]&&(r.field[e+n][t+o]={value:1,color:this.color,borderColor:this.borderColor});return q.refreshBlock()}}])&&a(e.prototype,n),o&&a(e,o),t}();function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function h(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var d=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=h(this,y(e).call(this,t,n,[[1,1],[1,1]]))).color="#ff7043",o.borderColor="#bf360c",o}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(e,t),n=e,(o=[{key:"rotate",value:function(){return!1}}])&&f(n.prototype,o),r&&f(n,r),e}(l);function v(t){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function b(t,e){return!e||"object"!==v(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(t,e){return(m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var k=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=b(this,w(e).call(this,t,n,[[1,1,1,1]]))).color="#009688",o.borderColor="#004d40",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(e,t),e}(l);function g(t){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function O(t,e){return!e||"object"!==g(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function x(t){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function S(t,e){return(S=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var P=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=O(this,x(e).call(this,t,n,[[0,1,1],[1,1,0]]))).color="#cddc39",o.borderColor="#9e9d24",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&S(t,e)}(e,t),e}(l);function _(t){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function E(t,e){return!e||"object"!==_(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function T(t,e){return(T=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var C=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=E(this,j(e).call(this,t,n,[[1,1,0],[0,1,1]]))).color="#ffa726",o.borderColor="#e65100",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&T(t,e)}(e,t),e}(l);function B(t){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function z(t,e){return!e||"object"!==B(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function L(t){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function R(t,e){return(R=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var A=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=z(this,L(e).call(this,t,n,[[1,0,0],[1,1,1]]))).color="#1E88E5",o.borderColor="#0D47A1",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&R(t,e)}(e,t),e}(l);function M(t){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function D(t,e){return!e||"object"!==M(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function F(t){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function I(t,e){return(I=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var H=function(t){function e(t,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(o=D(this,F(e).call(this,t,n,[[0,0,1],[1,1,1]]))).color="#7e57c2",o.borderColor="#311b92",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&I(t,e)}(e,t),e}(l);function X(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Y=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,o;return e=t,(n=[{key:"getRandomBlock",value:function(t,e){switch(Math.round(6*Math.random()+1)){case 1:return new d(t,e);case 2:return new l(t,e);case 3:return new k(t,e);case 4:return new P(t,e);case 5:return new C(t,e);case 6:return new A(t,e);case 7:return new H(t,e);default:return new l(t,e)}}}])&&X(e.prototype,n),o&&X(e,o),t}();function N(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var q=new(function(){function t(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),t.instance||(this.setProps(),this.drawNextBlock()),t.instance}var e,n,o;return e=t,(n=[{key:"setProps",value:function(){this.blockPicker=new Y,this.block=this.blockPicker.getRandomBlock(0,0),this.nextBlock=this.blockPicker.getRandomBlock(0,0),t.instance=this}},{key:"setX",value:function(e){t.instance.xSize=e}},{key:"setY",value:function(e){t.instance.ySize=e}},{key:"setSide",value:function(e){t.instance.side=e}},{key:"setField",value:function(e){t.instance.field=e}},{key:"refreshBlock",value:function(){return this.nextBlock.checkCollision(this.nextBlock.x,this.nextBlock.y)?(c.drawEndGame(),!1):(this.block=this.nextBlock,this.nextBlock=this.blockPicker.getRandomBlock(0,0),this.drawNextBlock(),!0)}},{key:"drawNextBlock",value:function(){var t=r.side<20?r.side:20,e=document.getElementById("nextBlock");e.width=this.nextBlock.shape[0].length*t,e.height=this.nextBlock.shape.length*t;var n=e.getContext("2d");this.nextBlock.draw(n,t)}},{key:"pause",value:function(){r.toggleActive()}},{key:"refresh",value:function(){this.setProps()}},{key:"drawBlock",value:function(){c.drawField(),this.block.draw()}},{key:"moveBlock",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"down";this.block.move(t)&&this.drawBlock()}},{key:"rotate",value:function(){this.block.rotate(),this.drawBlock()}},{key:"restart",value:function(){r.refresh(),this.refresh(),c.drawField()}}])&&N(e.prototype,n),o&&N(e,o),t}());function G(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var U=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.xDown=null,this.yDown=null,this.move=!1,this.timer,this.lockTimer,this.touchduration=300,this.interval=!1,this.shorttouch,this.handleTouchStart=this.handleTouchStart.bind(this),this.handleTouchMove=this.handleTouchMove.bind(this),this.handleTouchEnd=this.handleTouchEnd.bind(this),this.onLongTouch=this.onLongTouch.bind(this),this.addEventsListeners()}var e,n,o;return e=t,(n=[{key:"addEventsListeners",value:function(){var t=document.getElementById("tetris");t.addEventListener("touchstart",this.handleTouchStart,!1),t.addEventListener("touchmove",this.handleTouchMove,!1),t.addEventListener("touchend",this.handleTouchEnd,!1)}},{key:"handleTouchStart",value:function(t){var e=this.getTouches(t)[0];this.xDown=e.clientX,this.yDown=e.clientY,this.shorttouch=!0,this.lockTimer||(this.timer=setTimeout(this.onLongTouch,this.touchduration),this.lockTimer=!0)}},{key:"handleTouchMove",value:function(t){if(this.xDown&&this.yDown){this.move=!0;var e=t.touches[0].clientX,n=t.touches[0].clientY,o=this.xDown-e,r=this.yDown-n;Math.abs(o)>Math.abs(r)?o>0?q.moveBlock("left"):q.moveBlock("right"):r<0&&q.moveBlock("down"),this.xDown=null,this.yDown=null}}},{key:"handleTouchEnd",value:function(){this.timer&&(clearTimeout(this.timer),clearInterval(this.interval),this.lockTimer=!1),this.shorttouch&&!this.move&&q.rotate(),this.move=!1}},{key:"getTouches",value:function(t){return t.touches||t.originalEvent.touches}},{key:"onLongTouch",value:function(){var t=this;this.interval=setInterval((function(){t.shorttouch=!1,r.active&&(q.moveBlock("down"),r.checkField())}),100)}}])&&G(e.prototype,n),o&&G(e,o),t}();function V(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var W=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.setHandlers()}var e,n,o;return e=t,(n=[{key:"setHandlers",value:function(){document.addEventListener("keydown",(function(t){r.active&&("ArrowDown"==t.key&&q.moveBlock("down"),"ArrowUp"==t.key&&q.rotate(),"ArrowLeft"==t.key&&q.moveBlock("left"),"ArrowRight"==t.key&&q.moveBlock("right")),"Backspace"==t.key&&q.restart(),"Spacebar"!=t.key&&" "!=t.key||q.pause()}),!1)}}])&&V(e.prototype,n),o&&V(e,o),t}();function J(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var K=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.setHandlers()}var e,n,o;return e=t,(n=[{key:"setHandlers",value:function(){this.setRestart(),this.setPause()}},{key:"setRestart",value:function(){document.getElementById("restart").addEventListener("click",(function(){q.restart()}))}},{key:"setPause",value:function(){document.getElementById("pause").addEventListener("click",(function(){q.pause()}))}}])&&J(e.prototype,n),o&&J(e,o),t}();function Q(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Z=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,o;return e=t,o=[{key:"initApp",value:function(){new U,new W,new K,c.drawField(),setInterval((function(){r.active&&(q.moveBlock("down"),r.checkField())}),1e3)}}],(n=null)&&Q(e.prototype,n),o&&Q(e,o),t}();document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll("#instructions, #confirm_btn").forEach((function(t){t.addEventListener("click",(function(t){var e;t.stopPropagation(),t.preventDefault(),(e=document.getElementById("instructions"))&&e.classList.remove("active"),Z.initApp()}),!1)}))}))}]);